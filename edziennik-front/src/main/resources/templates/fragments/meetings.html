<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<!-- Fragment komponentu prazentujący listę spotkań dla zalogowanego użytkownika (jeżeli takie spotkania może mieć) -->
<section th:fragment="meetings" class="well">
    <div class="meetings-header">
        <div sec:authorize="hasAuthority('STUDENT')">
            <span class="section-title" th:text="'Terminarz spotkań dla klasy ' +  ${className}"></span>
        </div>
        <!-- Sekcja zmiany tygodnia planu
            Aby pobrać spotkania dla danego dnia trzeba zrobić request na taki url : /e-dziennik/meetings?date=10-10-2018
        -->
        <div align="center">
            <span class="section-title" th:text="${#dates.format(weekDates[0], 'dd.MM.yyyy')} + ' - ' + ${#dates.format(weekDates[6], 'dd.MM.yyyy')}"></span>
        </div>
    </div>

    <table class="table table-bordered table-responsive" align="center">
        <thead class="thead-dark">
        <tr>
            <th></th>
            <th class="meeting-row" th:each="day : ${days}">
                <span th:text="${day}"></span>
            </th>
        </tr>
        </thead>
        <tbody>
            <tr th:each="i: ${#numbers.sequence(1,10)}">
                <td class="meeting-row">
                    <span th:text="${hours[i-1].startTime} + ' - ' + ${hours[i-1].endTime}"></span>
                </td>
                <th:block th:each="j: ${#numbers.sequence(1,7)}">
                    <th:block th:if="${meetings[i-1][j-1] != null}">
                        <td class="meeting-row"
                            th:classappend="(${meetings[i-1][j-1].weekNumber == activeWeekNumber} ? 'table-secondary' : '') + ' ' +  (${meetings[i-1][j-1].active} ? 'table-primary' : '')">
                            <div th:text="${meetings[i-1][j-1].subjectName}"></div>
                            <div sec:authorize="hasAuthority('TEACHER')" th:text="'Klasa ' + ${meetings[i-1][j-1].className}"></div>
                        </td>
                    </th:block>
                    <th:block th:if="${meetings[i-1][j-1] == null}">
                        <td></td>
                    </th:block>
                </th:block>
            </tr>
        </tbody>
    </table>
</section>
</html>